var y=Object.defineProperty;var w=(i,t,e)=>t in i?y(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var r=(i,t,e)=>w(i,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}})();const c=50,u={x:354,y:752};class m{constructor(t,e){this.coordinates=t,this.color=e}}function C(i){const t=document.createElement("canvas"),e=t.getContext("2d");if(!e)throw new Error("Canvas context is not available.");t.width=i.width,t.height=i.height,e.drawImage(i,0,0,i.width,i.height);const a=e.getImageData(0,0,i.width,i.height),s=[];for(let n=0;n<i.height;n++){const o=[];for(let h=0;h<i.width;h++){const l=(n*i.width+h)*4,g=a.data[l],v=a.data[l+1],p=a.data[l+2],f=a.data[l+3],x=new m({x:h,y:n},{r:g,g:v,b:p,a:f});o.push(x)}s.push(o)}return s}class T{constructor(t){r(this,"canvas");r(this,"ctx");r(this,"scale",1);r(this,"translate",{x:0,y:0});r(this,"field",[]);r(this,"isDragging",!1);r(this,"dragStart",{x:0,y:0});r(this,"lastTranslate",{x:0,y:0});r(this,"activePixel",null);r(this,"onActivePixelChange",null);const e=this.createCanvas(),a=e.getContext("2d");if(!a)throw new Error("Cannot create Canvas context. Enable Javascript or Hardware acceleration if it's disabled.");this.canvas=e,this.ctx=a;const s=C(t);this.field=s,this.applyListeners()}createCanvas(){const t=document.createElement("canvas");return t.style.cssText=`
      display: block;
      padding: 0px;
      margin: 0px;
      width: 100vw;
      height: 100vh;
    `,t.width=window.innerWidth,t.height=window.innerHeight,t}appendCanvas(t){t.appendChild(this.canvas)}getCanvasBoundings(){return this.canvas.getBoundingClientRect()}clearCanvas(){const{width:t,height:e}=this.getCanvasBoundings();this.ctx.clearRect(0,0,t,e)}resizeCanvas(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.canvas.style.width="100vw",this.canvas.style.height="100vh"}applyListeners(){window.addEventListener("resize",this.resizeCanvas.bind(this)),this.canvas.addEventListener("mousemove",this.onMouseMove.bind(this)),this.canvas.addEventListener("wheel",this.onWheel.bind(this)),this.canvas.addEventListener("mousedown",this.onMouseDown.bind(this)),this.canvas.addEventListener("mouseup",this.onMouseUp.bind(this)),this.canvas.addEventListener("mouseleave",this.onMouseUp.bind(this)),this.canvas.addEventListener("touchstart",this.onTouchStart.bind(this)),this.canvas.addEventListener("touchmove",this.onTouchMove.bind(this)),this.canvas.addEventListener("touchend",this.onTouchEnd.bind(this))}onMouseMove(t){this.isDragging?this.onMouseMoveDrag(t):this.detectActivePixel(t)}onMouseMoveDrag(t){const e=t.clientX-this.dragStart.x,a=t.clientY-this.dragStart.y;this.translate.x=this.lastTranslate.x+e,this.translate.y=this.lastTranslate.y+a,this.render()}onMouseDown(t){this.isDragging=!0,this.dragStart={x:t.clientX,y:t.clientY},this.lastTranslate={...this.translate}}onMouseUp(){this.isDragging=!1}onTouchStart(t){if(t.touches.length===1){const e=t.touches[0];this.isDragging=!0,this.dragStart={x:e.clientX,y:e.clientY},this.lastTranslate={...this.translate}}}onTouchMove(t){if(this.isDragging&&t.touches.length===1){const e=t.touches[0],a=e.clientX-this.dragStart.x,s=e.clientY-this.dragStart.y;this.translate.x=this.lastTranslate.x+a,this.translate.y=this.lastTranslate.y+s,this.render()}}onTouchEnd(){this.isDragging=!1}detectActivePixel(t){var h,l;const e=this.canvas.getBoundingClientRect(),a=(t.clientX-e.left-this.translate.x)/this.scale,s=(t.clientY-e.top-this.translate.y)/this.scale,n=Math.floor(a/c),o=Math.floor(s/c);n>=0&&o>=0&&o<this.field.length&&n<this.field[0].length?(this.activePixel=this.field[o][n],(h=this.onActivePixelChange)==null||h.call(this,this.activePixel)):(this.activePixel=null,(l=this.onActivePixelChange)==null||l.call(this,null)),this.render()}onWheel(t){t.preventDefault();const e=this.canvas.getBoundingClientRect(),a=t.clientX-e.left,s=t.clientY-e.top,n=.1,o=t.deltaY<0?1+n:1-n;this.translate.x-=(a-this.translate.x)*(o-1),this.translate.y-=(s-this.translate.y)*(o-1),this.scale*=o,this.render()}drawImage(){for(const t of this.field)for(const e of t)this.ctx.fillStyle=`rgba(${e.color.r},${e.color.g},${e.color.b},1)`,this.ctx.fillRect(e.coordinates.x*c,e.coordinates.y*c,c,c);if(this.activePixel){const{x:t,y:e}=this.activePixel.coordinates;this.ctx.strokeStyle="rgba(255, 0, 255, 1)",this.ctx.lineWidth=2,this.ctx.strokeRect(t*c,e*c,c,c)}}applyTransforms(){this.ctx.setTransform(this.scale,0,0,this.scale,this.translate.x,this.translate.y)}render(){this.clearCanvas(),this.applyTransforms(),this.drawImage()}update(){}play(){this.update(),this.render(),window.requestAnimationFrame(this.play.bind(this))}}const d=new Image;d.src="https://yazmeyaa.github.io/duck_pixel/image.png";d.addEventListener("load",()=>{const i=new T(d);i.play(),i.appendCanvas(document.body);const t=document.getElementById("pixel_info");i.onActivePixelChange=e=>{if(t.innerHTML="",!e){t.innerHTML="";return}const a=document.createElement("span");a.innerText=`Coordinates: (${e.coordinates.x+u.x}:${e.coordinates.y+u.y}) `;const s=document.createElement("span");s.innerText=`Color: rgba(${e.color.r}, ${e.color.g}, ${e.color.b}, 1)`,t.appendChild(a),t.appendChild(s)}});
